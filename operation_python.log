
Thanks for your patience 
[33m1.Firstly, backup your vhd. The backup vhd will be used for further troubleshooting 
[36maz snapshot create -g development --source python_OsDisk_1_b52d49b660c048f9ba7e4e6e819e48d4-copy --name python_OsDisk_1_b52d49b660c048f9ba7e4e6e819e48d4-copy-snapshot
//Create new disk
az disk create --resource-group development --source python_OsDisk_1_b52d49b660c048f9ba7e4e6e819e48d4-copy-snapshot --name python_OsDisk_1_b52d49b660c048f9ba7e4e6e819e48d4-copy-copy --sku Premium_LRS
[33m2.Deallocate the virtual machine  
[36maz vm stop -g development -n python
[33m3.Create temporary troubleshooting virtual machine (for Premium vm, please use vm size Standard_DS1_v2)
[36maz vm create -g development --image Canonical:UbuntuServer:17.10:latest --admin-username azureuser --admin-password Azuretroubleshooting123! --name temp20180916 --size Standard_A1
[33m4.Attach the issued OS disk to the troubleshooting vm
[36maz vm disk attach --disk python_OsDisk_1_b52d49b660c048f9ba7e4e6e819e48d4-copy-copy --resource-group development --vm-name temp20180916
[33m5.After troubleshooting, detach the issued os disk from troubleshooting vm 
[36maz vm disk detach -g development --vm-name temp20180916 -n python_OsDisk_1_b52d49b660c048f9ba7e4e6e819e48d4-copy-copy
[33m6.Swap the modified os disk to the existing vm.
[36maz feature register --namespace "microsoft.compute" -n "AllowManagedDisksReplaceOSDisk"
az provider register -n microsoft.compute
az vm update --name python --resource-group development --os-disk /subscriptions/0f96dbcb-37cf-4c89-94ac-f9672a0ec207/resourceGroups/DEVELOPMENT/providers/Microsoft.Compute/disks/python_OsDisk_1_b52d49b660c048f9ba7e4e6e819e48d4-copy-copy
[0m    
